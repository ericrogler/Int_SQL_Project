# Intermediate SQL - Sales Analysis

## Overview

*Disclaimer: This is a SQL project generated by following along a Luke Barousse tutorial on YouTube going over intermediate-level SQL techniques, procedures, and knowledge.*

## Business Questions

1. **Customer Segmentation:** Who are our most valuable customers and how much do they contribute?
2. **Cohort Analysis:** How do different customer groups generate revenue?
3. **Retention Analysis:** Who hasn't purchased recently and what can incentize more purchases?

## Analysis Approach

### 1. Cohort Segmentation
- Assigning customers to different bands cohorts by High, Mid, and Low-value.
- KPIs: total revenue and average LTV.

Query: [1_customer_segmentation.sql](/Scripts/1_customer_segmentation.sql)

**Visualizations**

![Customer Cohorts vs Average LTV](https://files.oaiusercontent.com/file-9o92hrXpnYPAn8ch3y8aTu?se=2025-04-19T03%3A54%3A54Z&sp=r&sv=2024-08-04&sr=b&rscc=max-age%3D299%2C%20immutable%2C%20private&rscd=attachment%3B%20filename%3D0c44492f-5e65-4c64-861f-75c409464d4d&sig=XA2oWlAQBSJY3wADnLp8LEtBwpwbvXT5f8eizLKaHgI%3D)

**Key Findings**
Cohorts were divided based on 25th and 75th percentiles.

- High Value (Top 25% spending) drive 66% of revenue (~$135.4M).
- High Value (25% to 75% percentile) drive 32% of revenue (~$66.6M).
- Low Value (Bottom 25% spending) drive 2% of revenue (~$4.3M).

**Business Insights**

- High-Value: Offer premium memberships and benefits for retention; a single customer loss in this band is worth several mid or low value customers.
- Mid-Value: Create upgrades through promotions and offer incentives to encourage upgrades.
- Low-Value: Focus on engagement, discounts, savings, and price-sensitive deals to increase purchase frequency and amount.

### 2. Cohort Analysis
- Tracked revenue and customer count per cohorts.
- Cohorts were grouped by year of first purchase.
- Analyzed customer retention at a cohort level.

Query: [2_cohort_analysis.sql](/Scripts/2_cohort_analysis.sql)

**Visualizations**

![Customer Revenue by Cohort Year](https://files09.oaiusercontent.com/file-E2wZg7k77gJEy5M4V4afii?se=2025-04-19T03%3A47%3A44Z&sp=r&sv=2024-08-04&sr=b&rscc=max-age%3D299%2C%20immutable%2C%20private&rscd=attachment%3B%20filename%3D33b157d0-ec29-4166-ba75-9d4a7ace987f&sig=uymrGzji9XiuoxuYirf3DOgaTtzYbTsWGjNd1tFTXZM%3D)

![Total Revenue by Cohort Year](https://files.oaiusercontent.com/file-6NF5NbtkxKrwagYqEqhzhd?se=2025-04-19T03%3A48%3A32Z&sp=r&sv=2024-08-04&sr=b&rscc=max-age%3D299%2C%20immutable%2C%20private&rscd=attachment%3B%20filename%3D19faae12-052d-473f-a4b2-c4028d97685b&sig=9%2BtzH5aRcwBWQ4ofO/KWMCUqEk8UwlyztTO13w94kOk%3D)

**Key Findings**
- Revenue per customer shows significant decreasing trend over time.
    - 2022 to 2024 cohorts performing worse compared to earlier cohorts.
    - Net revenue is increasing, but likely due to larger customer base rather than higher per customer value.

**Business Insights**

- Value per customer decreasing over time requires investigation.
- 2023 saw customer decline, which may continue in future years without action taken.
- Decreasing LTV and acquistion indicates potential revenue decline.

### 3. Retention Analysis
- Identify active vs churned customers.
    - Whether OR NOT they've made a purchase within the LAST 6 months.
- Analyzed last purchase patterns.
- Calculate customer-specific metrics.

Query: [3_retention_analysis.sql](/Scripts/3_retention_analysis.sql)

**Visualizations**

![Churn Rate by Cohort Year](https://files09.oaiusercontent.com/file-3gupL1LvaP9X9VY11FLFTg?se=2025-04-19T03%3A58%3A03Z&sp=r&sv=2024-08-04&sr=b&rscc=max-age%3D299%2C%20immutable%2C%20private&rscd=attachment%3B%20filename%3De5324bf3-a17b-4733-a7ea-f28434c1b48a&sig=gOR2YX1Yxfvqvg8s9GHViVtl3HjEP6yDC3sVwlDYjWU%3D)

**Key Findings**

- Cohort churn stabilizes at ~90% after 2-3 years, showing consistent retention patterns.
- Retention rates are low (~8-10%) across all cohorts, suggesting systemic rather than biased retention issues.
-  Cohorts in recent years vs older cohorts still keep churn trajectory, indicating future cohorts will churn around the same without intervention.

**Business Insights**

- Strengthen engagement through onboarding incentives, loyalty rewards, and offers.
- Re-engage high value customers through win-back campaigns instead of general retention.
- Implement churn risk indicators to proactively intervene with at-risk users before they churn.

## Strategic Recommendations

As a recap of my findings and recommendations:

1. Decreasing LTV and acquistion indicates potential revenue decline.
2. Focus on premium packages for high-value customers, upgrades for mid-value customers, and discounts/savings packages to encourage purchases for low-value customers.
3. Implement churn risk indicators to proactively intervene with at-risk users before they churn.

## Technical Details
- **Database:** PostgreSQL
- **Analysis Tools:** Google Colab, DBeaver, PostgreSQL, and VS Code
- **Visualization:** ChatGPT